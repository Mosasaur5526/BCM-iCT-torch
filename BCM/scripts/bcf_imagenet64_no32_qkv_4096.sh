python -u scripts/cm_train.py \
  --training_mode consistency_training \
  --exp_name bcf_imagenet64_no32_qkv_4096 \
  --target_ema_mode adaptive \
  --start_ema 0.95 \
  --log_interval 100 \
  --save_interval 10000 \
  --scale_mode progressive \
  --start_scales 320 \
  --end_scales 320 \
  --total_training_steps 800000 \
  --loss_norm ict \
  --lr_anneal_steps 0 \
  --attention_resolutions 16,8 \
  --class_cond True \
  --use_scale_shift_norm False \
  --dropout 0.0 \
  --teacher_dropout 0.1 \
  --ema_rate 0.99997 \
  --global_batch_size 4096 \
  --image_size 64 \
  --lr 0.0001 \
  --num_channels 192 \
  --num_head_channels 64 \
  --num_res_blocks 3 \
  --resblock_updown True \
  --schedule_sampler uniform \
  --use_fp16 True \
  --weight_decay 0.0 \
  --weight_schedule ict \
  --data_dir IMAGENET_PATH/train \
  --bcf True \
  --pretrained_model_path CKPT_DIR/ict_imagenet64_no32_qkv_4096/ema_0.99997_600000.pt \
  # --resume_checkpoint CKPT_DIR/bcf_imagenet64_no32_qkv_4096/model234000.pt